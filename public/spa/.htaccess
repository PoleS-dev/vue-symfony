# Désactiver le listing des fichiers
Options -Indexes

# Configuration PWA
<IfModule mod_mime.c>
    AddType application/manifest+json .webmanifest
    AddType application/javascript .js
</IfModule>

<IfModule mod_headers.c>
    # Manifest PWA
    <Files "manifest.webmanifest">
        Header set Content-Type "application/manifest+json"
        Header set Cache-Control "public, max-age=3600"
    </Files>
    
    # Service Worker
    <FilesMatch "sw\.js">
        Header set Content-Type "application/javascript"
        Header set Cache-Control "no-cache, no-store, must-revalidate"
    </FilesMatch>
    
    # Icônes PWA
    <FilesMatch "\.(png|svg|ico)$">
        Header set Cache-Control "public, max-age=31536000"
    </FilesMatch>
</IfModule>

<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # Servir directement les fichiers PWA statiques
    RewriteCond %{REQUEST_FILENAME} -f
    RewriteCond %{REQUEST_URI} \.(webmanifest|js|png|svg|ico)$
    RewriteRule ^ - [L]
    
    # Rediriger vers l'index principal pour toutes les autres requêtes
    RewriteRule ^(.*)$ /index.php?route=$1 [QSA,L]
</IfModule>